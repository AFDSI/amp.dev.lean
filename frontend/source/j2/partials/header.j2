{% do doc.styles.addCssFile('css/components/atoms/icon.css') %}
{% do doc.styles.addCssFile('css/components/organisms/header.css') %}
{% do doc.icons.useIcon('icons/logo.svg') %}
{% do doc.icons.useIcon('icons/search.svg') %}
{% do doc.icons.useIcon('icons/globe.svg') %}
{% do doc.icons.useIcon('icons/menu.svg') %}
{% do doc.icons.useIcon('icons/angle-down-solid.svg') %}

{% import '/macros/atoms.j2' as atoms %}
{% set home = g.doc('/content/amp-dev/index.md') %}

<header class="ad-o-header">
  <div class="ad-o-header-wrapper">
    <input id="burger-menu-state" class="ad-o-header-burger-menu-btn" type="checkbox"/>
    <label class="ad-o-header-burger-menu" for="burger-menu-state">
      <div class="ad-a-ico ad-o-header-burger-menu-icon">
        <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu"></use></svg>
      </div>
    </label>

    {% set home = g.doc('/content/amp-dev/index.md') %}
    <div class="ad-o-header-lnk ad-o-header-lnk-home">
      <a class="ad-o-header-icon ad-o-header-icon-logo" href="{{ home.url.path }}">
        <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#logo"></use></svg>
        <span class="ad-o-header-icon-text ad-o-header-icon-text-uppercase">amp</span>
        <span class="ad-o-header-title">{{ doc.collection.title }}</span>
      </a>
    </div>
    <nav class="ad-o-header-nav ad-o-header-mainnav">
      {# Due to the UX design and behavior of the menu, two versions fo the navigation list are needed #}

      {# Mobile version #}
      <ul class="ad-o-header-list-mobile-expanded">
        <li class="ad-o-header-lnk ad-o-header-lnk-expanded ad-o-header-search ad-o-header-search-expanded">
          <button class="ad-o-header-search-button" name="search" type="submit">
            <a class="ad-o-header-icon" href="">
              <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#search"></use></svg>
            </a>
          </button>
          <form method="GET" id="ampsearch" action="//www.google.com/search" target="_top"></form>
        </li>

        {% for mainNav in g.collection('amp-dev').collections() %}
        {% if not loop.last %}
        {% for mainNavItem in g.docs(mainNav.collection_path) %}
        {% if mainNavItem.base == 'index' %}
        <li class="ad-o-header-lnk ad-o-header-lnk-expanded {% if doc.collection.parent.title == mainNav.title or doc.collection.title == mainNav.title %} ad-o-header-lnk-selected {% endif %}">
          <a href="{{ mainNavItem.url.path }}">{{ mainNav.title }}</a>
        </li>
        {% endif %}
        {% endfor %}
        {% else %}
        <li class="ad-o-header-lnk ad-o-header-lnk-expanded ad-o-header-lnk-support-expanded">
          <a href="">{{ mainNav.title }}</a>
        </li>
        {% endif %}
        {% endfor %}
      </ul>

      {# Desktop version #}
      <ul class="ad-o-header-list ad-o-header-list-desktop">
        {% for mainNav in g.collection('amp-dev').collections() %}
        {% if not loop.last %}
        {% for mainNavItem in g.docs(mainNav.collection_path) %}
        {% if mainNavItem.base == 'index' %}
        <li class="ad-o-header-lnk {% if doc.collection.parent.title == mainNav.title or doc.collection.title == mainNav.title %} ad-o-header-lnk-selected {% endif %}">
          <a href="{{ mainNavItem.url.path }}">{{ mainNav.title }}</a>
        </li>
        {% endif %}
        {% endfor %}

        {% else %}
        <li class="ad-o-header-lnk ad-o-header-search">
          <button class="ad-o-header-search-button" name="search" type="submit">
            <a class="ad-o-header-icon" href="">
              <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#search"></use></svg>
            </a>
          </button>
        </li>
        <li class="ad-o-header-lnk ad-o-header-lnk-support">
          <a href="">{{ mainNav.title }}</a>
        </li>

        <div class="ad-o-header-lang-switcher">
          <div class="ad-o-header-lang-current">
            <span>{{ doc.locale }}</span>
            <div class="ad-a-ico ad-o-header-lang-icon">
              <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#angle-down-solid"></use></svg>
            </div>
          </div>
          <ul class="ad-o-header-lang-list">
            {% for locale in doc.locales if not locale == doc.locale  %}
            {% set localized_doc = doc.localize(locale) %}
            <li class="ad-o-header-lang-list-item">
              <a href="{{ localized_doc.url.path }}">{{ locale }}</a>
            </li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
        {% endfor %}
      </ul>
    </nav>
    <nav class="ad-o-header-nav ad-o-header-subnav">
      <ul class="ad-o-header-list ad-o-header-list-subnav">
        {% for _doc in doc.collection %}
        {% if _doc.locale == doc.locale %}
        <li class="ad-o-header-lnk ad-o-header-lnk-subnav {% if _doc.title == doc.title %} ad-o-header-lnk-subnav-selected {% endif %}">
          <a href="{{ _doc.url.path }}">{{ _doc.title }}</a>
          {% if _doc.title == doc.title %}
          <div class="ad-o-header-lnk-divider"></div>
          {% endif %}
        </li>
        {% endif %}
        {% endfor %}
      </ul>
    </nav>
  </div>
</header>
