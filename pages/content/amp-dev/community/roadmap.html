---
$title: Roadmap
$order: 2
$view: /views/custom.j2
roadmap: !g.yaml /shared/data/roadmap.yaml

---
{% do doc.styles.addCssFile('css/components/templates/roadmap.css') %}

<main class="ap--main ap-t-roadmap">
  <section class="ap--stage ap--container-fluid">
    {% do doc.styles.addCssFile('css/components/organisms/stage.css') %}

    <div class="ap-o-stage">
      <div class="ap--container-fluid">
        <div class="ap-o-stage-content">
          <h1 class="ap-o-stage-content-headline">{{ _('The AMP Project Roadmap') }}</h1>
        </div>
        <div class="ap-o-stage-image">
          {% do doc.icons.useIcon('icons/roadmap-header.svg') %}
          <svg style="height: 80%; width: 100%;"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#roadmap-header"></use></svg>
        </div>
      </div>
    </div>
  </section>

  <div class="ap-o-roadmap">
    <section class="ap-o-roadmap-intro">
      <p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. For the overall AMP Roadmap for 2020 please read this blogpost.<br><br>An AMP Working Group is a segment of the community with knowledge/interest in specific area of AMP. Working Groups are created by AMP’s Technical Steering Committee.</p>
      <div class="ap-m-tip ap-m-tip-info">
        <div class="ap-m-tip-content">
          {% do doc.styles.addCssFile('css/components/molecules/tip.css') %}
          <p>{{ _('This is a high level overview, to look at detailed features up for consideration please head to <a href="https://github.com/ampproject/amphtml/projects/43">Github</a>. You can vote on issues, leave feedback or create a new issue.') }}</p>
        </div>
      </div>
    </section>

    <section class="ap-o-roadmap-filter">
      {% do doc.styles.addCssFile('css/components/organisms/filter-bubbles-list.css') %}
      {% do doc.icons.useIcon('icons/close.svg') %}

      <h2>{{ _('Select working groups') }}</h2>
      <div class="ap-o-roadmap-filter-list">
        <div class="ap-m-filter-bubble" style="background: #005af0;">
          <button class="ap-m-filter-bubble-button reset [% if not category %]active[% endif %]"
              on="tap:AMP.navigateTo(url='{{ doc.url.path }}')">
            {{ _('All') }}
          </button>
        </div>

        {% for workingGroup in doc.roadmap.working_groups %}
        <div class="ap-m-filter-bubble" style="background: {{ workingGroup.color }};">
          <button class="ap-m-filter-bubble-button {{ workingGroup.slug }} [% if category == '{{ workingGroup.slug }}' %]active[% endif %]"
            on="tap:AMP.navigateTo(url='{{ doc.url.path }}?category={{ workingGroup.slug }}')">
            {{ workingGroup.name }}
          </button>
        </div>
        {% endfor %}
      </div>
    </section>

    <section class="ap-o-roadmap-container">
      <div class="ap-o-roadmap-navigation">
        <div class="ap-o-roadmap-navigation-list">
          {% for quarter in doc.roadmap.list|map(attribute='quarter')|unique|list %}

          {% set roadmap_quarter = dict(doc.roadmap.list|groupby('quarter')) %}
          [% set roadmap_filtered = {{ dict(roadmap_quarter[quarter]|groupby('wg_slug'))|tojson }} %]

          [% if not category or roadmap_filtered[category]|length > 0 %]
          <amp-animation id="anim-{{ quarter|slug }}" layout="nodisplay">
            <script type="application/json">
              {
                "duration": ".3s",
                "fill": "both",
                "direction": "alternate",
                "animations": [
                  {
                    "selector": ".ap-o-roadmap-navigation-list-item",
                    "keyframes": {
                      "opacity": ".3"
                    }
                  },
                  {
                    "selector": "#nav-item-{{ quarter|slug }}",
                    "keyframes": {
                      "opacity": "1"
                    }
                  },
                  {
                    "selector": ".ap-o-roadmap-navigation-list-item-timeline",
                    "keyframes": {
                      "opacity": "0"
                    }
                  },
                  {
                  "selector": "#nav-item-timeline-{{ quarter|slug }}",
                  "keyframes": {
                    "opacity": "1"
                  }
                }]
              }
            </script>
          </amp-animation>
          <button class="ap-o-roadmap-navigation-list-item"
              id="nav-item-{{ quarter|slug }}"
              on="tap:{{ quarter|slug }}.scrollTo(duration=250)">
            <h3 class="ap-o-roadmap-navigation-list-item-title">
              {{ quarter }}
            </h3>
            <span class="ap-o-roadmap-navigation-list-item-timeline"
                id="nav-item-timeline-{{ quarter|slug }}">
            </span>
          </button>
          [% endif %]

          {% endfor %}
        </div>
      </div>

      <div class="ap-o-roadmap-list">
        {% do doc.icons.useIcon('icons/chevron-vertical-light.svg') %}

        {% for issue in doc.roadmap.list %}
        [% if category in '{{ issue.wg_slug }}' %]
        {% if loop.changed(issue.quarter) %}
        <amp-position-observer intersection-ratios="1"
            target="{{ issue.quarter|slug }}"
            on="enter:anim-{{ issue.quarter|slug }}.start"
            layout="nodisplay">
        </amp-position-observer>
        <div class="ap-o-roadmap-list-quarter-separator" id="{{ issue.quarter|slug }}">
          <h3>{{ issue.quarter }}</h3>
        </div>
        {% endif %}
        <div class="ap-o-roadmap-list-item">
          <span class="ap-o-roadmap-list-item-timeline ap-o-roadmap-list-item-timeline--vertical"></span>
          <span class="ap-o-roadmap-list-item-timeline ap-o-roadmap-list-item-timeline--horizontal">
            <span class="ap-o-roadmap-list-item-timeline-dot"></span>
          </span>

          <div class="ap-o-roadmap-list-item-issue {{ issue.wg_slug }}"
              id="roadmap-item-{{ issue.wg_slug }}"
              style="border-color: {{ issue.color }};">
            <amp-truncate-text layout="fixed-height" height="12em">
              <h4 class="ap-o-roadmap-list-item-issue-title">{{ issue.wg_name }}</h4>
              <span class="ap-o-roadmap-list-item-issue-subtitle">Status Update {{ issue.status_update }}</span>
              <div class="ap-o-roadmap-list-item-issue-body">
                {% for column in issue.body|slice(2) %}
                <div class="ap-o-roadmap-list-item-issue-body-column">
                  {% for paragraph in column %}
                  <div>{{ paragraph|markdown|safe }}</div>
                  {% endfor %}
                  {% if loop.last %}
                  <a href="{{ issue.html_url }}" class="ap-m-lnk">
                    <div class="ap-a-ico ap-m-lnk-icon">
                      {% do doc.icons.useIcon('icons/internal.svg') %}
                      <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#internal"></use></svg>
                    </div>
                    <span class="ap-m-lnk-text">{{ _('All details on GitHub') }}</span>
                  </a>
                  {% endif %}
                </div>
                {% endfor %}
              </div>
              <button class="ap-o-roadmap-list-item-issue-button" slot="collapsed">
                <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#chevron-vertical-light"></use></svg>
              </button>
              <button class="ap-o-roadmap-list-item-issue-button" slot="expanded">
                <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#chevron-vertical-light"></use></svg>
              </button>
            </amp-truncate-text>
          </div>

        </div>

        [% endif %]
        {% endfor %}
      </div>

    </section>
  </div>

</main>
